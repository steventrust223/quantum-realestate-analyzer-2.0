<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .container {
      background: white;
      border-radius: 15px;
      padding: 30px;
      max-width: 100%;
    }

    h1 {
      color: #667eea;
      margin-bottom: 10px;
      font-size: 2em;
    }

    .subtitle {
      color: #666;
      margin-bottom: 30px;
      font-size: 1.1em;
    }

    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
      border-bottom: 2px solid #e0e0e0;
    }

    .tab {
      padding: 12px 24px;
      background: none;
      border: none;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      font-size: 1em;
      color: #666;
      transition: all 0.3s;
    }

    .tab.active {
      color: #667eea;
      border-bottom-color: #667eea;
      font-weight: 600;
    }

    .tab:hover {
      color: #667eea;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .info-card {
      background: #f9f9f9;
      padding: 20px;
      border-radius: 10px;
      border-left: 4px solid #667eea;
    }

    .info-label {
      font-size: 0.9em;
      color: #999;
      margin-bottom: 5px;
    }

    .info-value {
      font-size: 1.2em;
      color: #333;
      font-weight: 500;
    }

    .team-list {
      list-style: none;
    }

    .team-member {
      display: flex;
      align-items: center;
      padding: 15px;
      background: #f9f9f9;
      margin-bottom: 10px;
      border-radius: 8px;
    }

    .team-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      margin-right: 15px;
      font-size: 1.2em;
    }

    .team-info {
      flex: 1;
    }

    .team-name {
      font-weight: 600;
      color: #333;
    }

    .team-role {
      font-size: 0.9em;
      color: #666;
    }

    .btn {
      padding: 10px 24px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 0.95em;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-secondary {
      background: #e0e0e0;
      color: #333;
    }

    .section-title {
      font-size: 1.3em;
      color: #333;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid #667eea;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üè¢ CompanyHub</h1>
    <p class="subtitle">Centralized company management</p>

    <div class="tabs">
      <button class="tab active" onclick="showTab('overview')">Overview</button>
      <button class="tab" onclick="showTab('team')">Team</button>
      <button class="tab" onclick="showTab('documents')">Documents</button>
      <button class="tab" onclick="showTab('settings')">Settings</button>
    </div>

    <!-- Overview Tab -->
    <div id="overview" class="tab-content active">
      <h2 class="section-title">Company Overview</h2>
      <div class="info-grid">
        <div class="info-card">
          <div class="info-label">Company Name</div>
          <div class="info-value" id="companyName">-</div>
        </div>
        <div class="info-card">
          <div class="info-label">Total Deals</div>
          <div class="info-value" id="totalDeals">0</div>
        </div>
        <div class="info-card">
          <div class="info-label">Active Team Members</div>
          <div class="info-value" id="teamCount">0</div>
        </div>
        <div class="info-card">
          <div class="info-label">Total Revenue (YTD)</div>
          <div class="info-value" id="ytdRevenue">$0</div>
        </div>
      </div>

      <h2 class="section-title">Quick Stats</h2>
      <div class="info-grid">
        <div class="info-card">
          <div class="info-label">Wholesaling Deals</div>
          <div class="info-value" id="wholesalingCount">0</div>
        </div>
        <div class="info-card">
          <div class="info-label">Sub2 Deals</div>
          <div class="info-value" id="sub2Count">0</div>
        </div>
        <div class="info-card">
          <div class="info-label">Active Buyers</div>
          <div class="info-value" id="activeBuyers">0</div>
        </div>
        <div class="info-card">
          <div class="info-label">Active Sellers</div>
          <div class="info-value" id="activeSellers">0</div>
        </div>
      </div>
    </div>

    <!-- Team Tab -->
    <div id="team" class="tab-content">
      <h2 class="section-title">Team Members</h2>
      <ul class="team-list" id="teamList">
        <li class="team-member">
          <div class="team-avatar">?</div>
          <div class="team-info">
            <div class="team-name">Loading team members...</div>
            <div class="team-role">Please wait</div>
          </div>
        </li>
      </ul>
      <button class="btn btn-primary" onclick="alert('Add team member functionality')">+ Add Team Member</button>
    </div>

    <!-- Documents Tab -->
    <div id="documents" class="tab-content">
      <h2 class="section-title">Document Management</h2>
      <p style="color: #666; margin-bottom: 20px;">Manage your contracts, templates, and legal documents</p>
      <div class="info-grid">
        <div class="info-card">
          <div class="info-label">Total Documents</div>
          <div class="info-value" id="docCount">0</div>
        </div>
        <div class="info-card">
          <div class="info-label">Templates</div>
          <div class="info-value">Available in Drive</div>
        </div>
      </div>
      <button class="btn btn-primary" onclick="alert('Document upload feature')">üì§ Upload Document</button>
    </div>

    <!-- Settings Tab -->
    <div id="settings" class="tab-content">
      <h2 class="section-title">Company Settings</h2>
      <p style="color: #666;">Configure settings in the Settings sheet of your spreadsheet</p>
    </div>
  </div>

  <script>
    function showTab(tabName) {
      // Hide all tabs
      const contents = document.getElementsByClassName('tab-content');
      for (let content of contents) {
        content.classList.remove('active');
      }

      // Remove active from all tab buttons
      const tabs = document.getElementsByClassName('tab');
      for (let tab of tabs) {
        tab.classList.remove('active');
      }

      // Show selected tab
      document.getElementById(tabName).classList.add('active');
      event.target.classList.add('active');

      // Load tab data
      if (tabName === 'overview') {
        loadOverviewData();
      } else if (tabName === 'team') {
        loadTeamData();
      }
    }

    function loadOverviewData() {
      google.script.run.withSuccessHandler(updateOverview).getCompanyOverview();
    }

    function loadTeamData() {
      google.script.run.withSuccessHandler(updateTeamList).getTeamMembers();
    }

    function updateOverview(data) {
      document.getElementById('companyName').textContent = data.companyName || 'Not set';
      document.getElementById('totalDeals').textContent = data.totalDeals || 0;
      document.getElementById('teamCount').textContent = data.teamCount || 0;
      document.getElementById('ytdRevenue').textContent = '$' + (data.ytdRevenue || 0).toLocaleString();
      document.getElementById('wholesalingCount').textContent = data.wholesalingCount || 0;
      document.getElementById('sub2Count').textContent = data.sub2Count || 0;
      document.getElementById('activeBuyers').textContent = data.activeBuyers || 0;
      document.getElementById('activeSellers').textContent = data.activeSellers || 0;
    }

    function updateTeamList(team) {
      const teamList = document.getElementById('teamList');
      teamList.innerHTML = '';

      if (!team || team.length === 0) {
        teamList.innerHTML = '<li class="team-member"><div class="team-info"><div class="team-name">No team members found</div><div class="team-role">Add team members in the Team Members sheet</div></div></li>';
        return;
      }

      team.forEach(member => {
        const initial = member.name.charAt(0).toUpperCase();
        const li = document.createElement('li');
        li.className = 'team-member';
        li.innerHTML = `
          <div class="team-avatar">${initial}</div>
          <div class="team-info">
            <div class="team-name">${member.name}</div>
            <div class="team-role">${member.role} ‚Ä¢ ${member.email}</div>
          </div>
        `;
        teamList.appendChild(li);
      });
    }

    // Load overview on open
    loadOverviewData();
  </script>
</body>
</html>
